kind: Kustomization
apiVersion: kustomize.config.k8s.io/v1beta1
# The app: ds label is used for anti-affinity. See statefulset.yaml.
commonLabels:
  app: ds
resources:
- service.yaml
- statefulset.yaml
secretGenerator:
 - name: ds
   files:
   - secrets/keystore.pin
   - secrets/keystore
vars:
- name: DS_INSTANCE
  objref:
    kind: StatefulSet
    apiVersion: apps/v1
    name: ds
  fieldref:
    fieldpath: metadata.name