# Copyright (c) 2016-2017 ForgeRock AS.

# The default instance name. This will create a stateful set that can be resolved at
#  $djInstance-0.$djInstance
djInstance: userstore


# Default password
dirManagerPassword: password

# The default bootstrap script.
bootstrapScript: "/opt/opendj/bootstrap/setup.sh"

# The other option here is "cts". This sets the BOOTSTRAP_TYPE env var for the bootstrap script.
bootstrapType: "userstore"


# The OpenDJ baseDN
baseDN: "dc=openam,dc=forgerock,dc=org"


# The host where backups will be scheduled. Set this to the instance name where you want to run backups.
# Example: userstore-0.
# To disable scheduled backups, use a host name that does not match.
# 
backupHost: dontbackup

# Backup schedules for full and incrementals. 
backupScheduleFull:  "2 2 * * *"
backupScheduleIncremental: "15 * * * *"


component: opendj

global:
  image:
    #repository: forgerock
    repository: gcr.io/engineering-devops
    name: opendj
    #pullPolicy: IfNotPresent
    pullPolicy: Always
    tag:  6.0.0

directoryServer:
  replicas: 3
  # Size for OpenDJ storage. Note GKE IOPS scale based on the size of the volume.
  storageSize: "20Gi"
  # DS nodes need fast (SSD) storage. Your cluster admin must create a 'fast' storage class.
  storageClass: "fast"
  resources:
    requests:
     memory: 4024Mi

replicationServer:
  replicas: 2
   # Size for OpenDJ storage. Note GKE IOPS scale based on the size of the volume.
  storageSize: "10Gi"
  storageClass: "fast"
  resources:
    requests:
     memory: 4024Mi

# Set for creating sample users. If unset, only the base DN will be created.
#numberSampleUsers: 5


# Set storageClass only on clusters that support it (GCP / AWS).
#storageClass: fast

# You need to be on JDK 8u131 or higher to enable these options.
opendjJavaArgs: "-server -XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap"

# Resource limits.
# These help for pod placement on a larger cluster to ensure the OpenDJ instance gets sufficient resources.


# DJ persistence switch. Setting to false disables volume claims - all data is stored inside the docker image.
# Used in testing environments without pv providers. When the pod is terminated, the DJ data will be deleted!
# See issue https://github.com/kubernetes/kubernetes/issues/2630,
# which impacts minikube (or any hostPath based provisioner). The underlying PV has root permissions,
# and the DJ container will not start. If you need to run this on Minikube with PVC, set runAsUser: 0 in the
# deployment securityContext:
djPersistence: true


# Set this to true to enable backups to gcloud
enableGcloudBackups: false

# backup Bucket destination. You need the right scopes in container engine to write to this bucket. add --scopes storage-full when you create the cluster.
gsBucket: gs://forgeops/dj-backup 

# Uncomment this to create sample users in the DS. The value must be quoted as a string
# Note large values here will cause init failure as the initial setup takes too long and the pod will be killed.
numberSampleUsers: "5000"
